<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Учебный дневник</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/style_diary.css">
</head>
<body>
<header>
    <img src="../images/logo.png" alt="Логотип">
    <h2>Цатурян Давид</h2>
    <nav>
        <a href=../index.html>Главная</a>
        <a href="projects.html">Проекты</a>
        <a href="diary.html" class="active">Дневник</a>
        <a href="contacts.html">Контакты</a>
    </nav>
</header>
<section class="container my-5">
    <h3 class="text-center mb-4">Мой учебный прогресс</h3>
    <div class="progress-box mx-auto p-3">
        <table class="table table-borderless table-hover">
            <thead class="table-light">
            <tr>
                <th class="text-nowrap ps-3">Дата</th>
                <th class="ps-3">Задача</th>
                <th class="text-center pe-3">Статус</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
    </div>
    <div class="text-center mt-4">
        <button type="button" class="btn btn-custom" data-bs-toggle="modal" data-bs-target="#addTaskModal">
            + Добавить задачу
        </button>
    </div>
</section>
<!-- Модальное окно -->
<div class="modal fade" id="addTaskModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Добавить учебную задачу</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <div class="mb-3">
                        <label for="taskDate" class="form-label">Дата</label>
                        <input type="date" class="form-control" id="taskDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="taskName" class="form-label">Задача</label>
                        <input type="text" class="form-control" id="taskName" placeholder="Введите название задачи" required>
                    </div>
                    <div class="mb-3">
                        <label for="taskStatus" class="form-label">Статус</label>
                        <select class="form-select" id="taskStatus" required>
                            <option value="completed">Выполнено</option>
                            <option value="inProgress" selected>В процессе</option>
                            <option value="planned">Запланировано</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                <button type="button" class="btn btn-custom" id="addTaskBtn">Добавить</button>
            </div>
        </div>
    </div>
</div>
<section class="container mb-5">
    <h4 class="text-center mb-4">Текущие курсы</h4>
    <div class="mb-3">Веб-разработка
        <div class="progress">
            <div class="progress-bar bg-secondary" style="width:90%">90%</div>
        </div>
    </div>
    <div class="mb-3">JavaScript
        <div class="progress">
            <div class="progress-bar bg-secondary" style="width:70%">70%</div>
        </div>
    </div>
    <div class="mb-3">React
        <div class="progress">
            <div class="progress-bar bg-secondary" style="width:50%">50%</div>
        </div>
    </div>
</section>
<footer>
    © 2025 Контакты
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const addTaskBtn = document.getElementById("addTaskBtn");
        const tableBody = document.querySelector("table tbody");
        const taskForm = document.getElementById("taskForm");
        const modalEl = document.getElementById("addTaskModal");

        // Загружаем сохранённые задачи при открытии страницы
        const savedTasks = JSON.parse(localStorage.getItem("tasks") || "[]");
        savedTasks.forEach(task => addTaskToTable(task));

        // При нажатии "Добавить"
        addTaskBtn.addEventListener("click", () => {
            const date = document.getElementById("taskDate").value;
            const name = document.getElementById("taskName").value.trim();
            const status = document.getElementById("taskStatus").value;

            if (!date || !name) {
                alert("Пожалуйста, заполните все поля!");
                return;
            }

            const newTask = { date, name, status };
            addTaskToTable(newTask);

            // Сохраняем в localStorage
            savedTasks.push(newTask);
            localStorage.setItem("tasks", JSON.stringify(savedTasks));

            // Очищаем форму
            taskForm.reset();

            // Закрываем модалку
            const modal = bootstrap.Modal.getOrCreateInstance(modalEl);
            modal.hide();

            //alert("Запись успешно добавлена!");
        });

        // Функция добавления строки в таблицу
        function addTaskToTable(task) {
            const row = document.createElement("tr");
            row.innerHTML = `
            <td class="ps-3">${task.date}</td>
            <td class="ps-3">${task.name}</td>
            <td class="text-center pe-3">
                <span class="badge ${task.status === "completed" ? "bg-success" : task.status === "inProgress" ? "bg-warning text-dark" : "bg-secondary"}">
                    ${task.status === "completed" ? "Выполнено" : task.status === "inProgress" ? "В процессе" : "Запланировано"}
                </span>
                <button class="btn btn-sm btn-outline-danger ms-2 delete-btn">✖</button>
            </td>
        `;
            tableBody.appendChild(row);

            // Удаление записи
            row.querySelector(".delete-btn").addEventListener("click", () => {
                row.remove();
                const index = savedTasks.findIndex(t => t.date === task.date && t.name === task.name && t.status === task.status);
                if (index !== -1) {
                    savedTasks.splice(index, 1);
                    localStorage.setItem("tasks", JSON.stringify(savedTasks));
                }
            });
        }
    });
</script>
</body>
</html>
